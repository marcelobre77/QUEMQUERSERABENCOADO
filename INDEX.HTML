<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mapa BÃ­blico - O Jogo</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Roboto+Slab:wght@400;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Roboto Slab', serif;
            touch-action: manipulation; /* Improves mobile responsiveness */
        }
        .board-grid {
            grid-template-columns: repeat(6, minmax(0, 1fr));
        }
        .board-cell {
            aspect-ratio: 1 / 1;
            position: relative;
        }
        .player-token {
            width: 25%;
            height: 25%;
            border-radius: 50%;
            position: absolute;
            transition: all 0.5s ease-in-out;
            border: 2px solid white;
            box-shadow: 0 2px 4px rgba(0,0,0,0.2);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.6rem;
            color: white;
            font-weight: bold;
        }
        .player-red { background-color: #ef4444; }
        .player-blue { background-color: #3b82f6; }
        .player-yellow { background-color: #eab308; }
        .token-red { top: 10%; left: 10%; }
        .token-blue { top: 10%; right: 10%; }
        .token-yellow { bottom: 10%; left: 10%; }

        #modal {
            transform: scale(0.95);
            opacity: 0;
            visibility: hidden;
            transition: all 0.2s ease-in-out;
        }
        #modal.active {
            transform: scale(1);
            opacity: 1;
            visibility: visible;
        }
        /* Hide number input arrows */
        input[type=number]::-webkit-inner-spin-button, 
        input[type=number]::-webkit-outer-spin-button { 
          -webkit-appearance: none; 
          margin: 0; 
        }
        input[type=number] {
          -moz-appearance: textfield;
        }
    </style>
</head>
<body class="bg-amber-50 text-stone-800 flex items-center justify-center min-h-screen p-4">

    <!-- Game Container -->
    <div id="gameContainer" class="w-full max-w-4xl mx-auto hidden">
        <h1 class="text-4xl md:text-5xl font-bold text-center text-amber-800 mb-4">Mapa BÃ­blico</h1>
        
        <!-- Game Board -->
        <div class="bg-amber-200 p-4 rounded-2xl shadow-lg border-4 border-amber-300">
            <div id="board" class="grid board-grid gap-2">
                <!-- Cells will be generated by JS -->
            </div>
        </div>

        <!-- Controls -->
        <div class="mt-6 p-4 bg-white rounded-2xl shadow-md">
            <div class="flex flex-col md:flex-row items-center justify-between gap-4">
                <div class="text-center">
                    <p class="text-lg">Vez do time:</p>
                    <div id="currentPlayerIndicator" class="w-24 h-10 rounded-lg mx-auto mt-1 transition-colors"></div>
                </div>
                <div class="text-center">
                    <label for="diceInput" class="text-2xl font-bold">Valor do Dado</label>
                    <input type="number" id="diceInput" min="1" max="6" class="text-center text-4xl font-bold text-stone-700 w-24 h-16 border-2 border-stone-300 rounded-lg mt-1" placeholder="1-6">
                </div>
                <button id="movePlayerBtn" class="bg-amber-600 text-white text-xl font-bold py-3 px-8 rounded-lg shadow-md hover:bg-amber-700 transition transform hover:scale-105 active:scale-95 w-full md:w-auto">
                    AvanÃ§ar Casas
                </button>
            </div>
        </div>
    </div>

    <!-- Setup Screen -->
    <div id="setupScreen" class="text-center bg-white p-8 rounded-2xl shadow-xl">
        <h1 class="text-4xl font-bold text-amber-800 mb-2">Bem-vindo ao Mapa BÃ­blico!</h1>
        <p class="text-stone-600 mb-8">Selecione o nÃºmero de times para comeÃ§ar a jornada.</p>
        <div class="flex justify-center gap-4">
            <button onclick="startGame(2)" class="bg-blue-500 text-white text-xl font-bold py-3 px-8 rounded-lg shadow-md hover:bg-blue-600 transition transform hover:scale-105">2 Times</button>
            <button onclick="startGame(3)" class="bg-red-500 text-white text-xl font-bold py-3 px-8 rounded-lg shadow-md hover:bg-red-600 transition transform hover:scale-105">3 Times</button>
        </div>
    </div>
    
    <!-- Modal for Questions/Challenges/Winner -->
    <div id="modal" class="fixed inset-0 bg-black bg-opacity-60 flex items-center justify-center p-4">
        <div class="bg-white p-6 rounded-2xl shadow-2xl max-w-md w-full text-center">
            <h2 id="modalTitle" class="text-2xl font-bold mb-4 text-amber-800">Desafio da Casa 10</h2>
            <p id="modalText" class="text-stone-700 mb-6 text-lg">Aqui vai o texto da pergunta ou da prenda.</p>
            <div id="modalActions" class="flex flex-col sm:flex-row justify-center gap-3">
                <!-- Action buttons will be generated by JS -->
            </div>
        </div>
    </div>


<script>
    // --- GAME DATA ---
    const challenges = {
        1: [
            { type: 'question', text: 'Diga quais sÃ£o os 5 primeiros livros da BÃ­blia (Pentateuco) na ordem correta.', correct: { action: 'move', spaces: 2, msg: 'Correto! Avance 2 casas.' }, incorrect: { action: 'stay', msg: 'Errado! Fique onde estÃ¡.' } },
            { type: 'question', text: 'Quem foi o primeiro Rei de Israel?', correct: { action: 'move', spaces: 1, msg: 'Saul! Correto, avance 1.' }, incorrect: { action: 'stay', msg: 'Incorreto.' } },
            { type: 'question', text: 'Qual rei babilÃ´nico perdeu seu reinado apÃ³s zombar das coisas de Deus?', correct: { action: 'move', spaces: 2, msg: 'Belsazar! Correto, avance 2.' }, incorrect: { action: 'stay', msg: 'Incorreto.' } },
            { type: 'question', text: 'Em Qual livro de profeta menor, contÃ©m a declaraÃ§Ã£o â€œo justo viverÃ¡ pela sua fÃ©â€?', correct: { action: 'move', spaces: 3, msg: 'Habacuque! Correto, avance 3.' }, incorrect: { action: 'stay', msg: 'Incorreto.' } }
        ],
        2: [
            { type: 'challenge', text: 'Cante um trecho de um hino que vocÃª goste sÃ³ quem em estilo hip hop.', complete: { action: 'stay', msg: 'Bela voz! Fique onde estÃ¡.' }, incomplete: { action: 'move', spaces: -1, msg: 'Que pena! Volte 1 casa.' } },
            { type: 'challenge', text: 'AgradeÃ§a a Deus por 3 coisas em sua vida imitando a voz do finado Silvio Santos.', complete: { action: 'move', spaces: 1, msg: 'AmÃ©m! Avance 1 casa.' }, incomplete: { action: 'stay', msg: 'A gratidÃ£o Ã© importante. Fique onde estÃ¡.' } }
            
        ],
        3: [
            { type: 'question', text: 'Quem foi chamado de careca por vÃ¡rios jovens?', correct: { action: 'move', spaces: 2, msg: 'Isso mesmo, Eliseu! Avance 2 casas.' }, incorrect: { action: 'stay', msg: 'Resposta errada. Fique onde estÃ¡.' } },
            { type: 'question', text: 'Quem era o pai de Davi?', correct: { action: 'move', spaces: 2, msg: 'JessÃ©! Correto, avance 2.' }, incorrect: { action: 'stay', msg: 'Errado.' } },
            { type: 'question', text: 'Quem era a mÃ£e de Ismael?', correct: { action: 'move', spaces: 2, msg: 'Isso mesmo, Hagar! Avance 2 casas.' }, incorrect: { action: 'stay', msg: 'Resposta errada. Fique onde estÃ¡.' } },
            { type: 'question', text: 'Quem eram os 3 filhos de NoÃ©?', correct: { action: 'move', spaces: 2, msg: 'CÃ£o,Sem e JafÃ©! Correto, avance 2.' }, incorrect: { action: 'stay', msg: 'Errado.' } }
        ],
        4: [
            { type: 'question', text: 'Qual foi a ultima praga no Egito?', correct: { action: 'move', spaces: 1, msg: 'Correto, Morte dos Primogenitos! Avance 1 casa.' }, incorrect: { action: 'stay', msg: 'NÃ£o foi dessa vez. PermaneÃ§a.' } },
            { type: 'challenge', text: 'Cite o nome de 6 dos 12 discÃ­pulos.', complete: { action: 'move', spaces: 2, msg: 'Excelente! Avance 2 casas.' }, incomplete: { action: 'stay', msg: 'Precisa estudar mais. Fique parado.' } },
            { type: 'question', text: 'Mical era filha de quem?', correct: { action: 'move', spaces: 1, msg: 'Correto, Saul! Avance 1 casa.' }, incorrect: { action: 'stay', msg: 'NÃ£o foi dessa vez. PermaneÃ§a.' } },
            { type: 'challenge', text: 'Cite o nome de 3 das Igrejas mencionadas no Apocalipse.', complete: { action: 'move', spaces: 2, msg: 'Excelente! Avance 2 casas.' }, incomplete: { action: 'stay', msg: 'Precisa estudar mais. Fique parado.' } }
        ],
        5: [
            { type: 'lucky', text: 'VocÃª achou a Arca da AlianÃ§a que estava perdida! Avance 3 casas.', action: 'move', spaces: 3 }
        ],
        6: [
            { type: 'challenge', text: 'Fale o nome de 3 profetas maiores.', complete: { action: 'move', spaces: 2, msg: 'Excelente! Avance 2 casas.' }, incomplete: { action: 'stay', msg: 'Estude mais um pouco. Fique onde estÃ¡.' } },
            { type: 'question', text: 'Quais eram os nomes de Sadraque, Mesaque e Abedi Nego antes da BabilÃ´nia?', correct: { action: 'move', spaces: 2, msg: 'Hananias, Misael e Azarias.! Correto. Avance 2.' }, incorrect: { action: 'stay', msg: 'Errado.' } },
            { type: 'challenge', text: 'Diga 7 dos 10 Mandamentos', complete: { action: 'move', spaces: 1, msg: 'Boa memÃ³ria! Avance 1 casa.' }, incomplete: { action: 'stay', msg: 'Quase. Fique onde estÃ¡.' } },
            { type: 'question', text: 'Quantos anos de fome extrema tiveram no Egito e no mundo na Ã©poca de JosÃ©?', correct: { action: 'move', spaces: 2, msg: '7 anos.! Correto. Avance 2.' }, incorrect: { action: 'stay', msg: 'Errado.' } }
        ],
        7: [
            { type: 'question', text: 'Onde Jesus fez seu primeiro milagre?', correct: { action: 'move', spaces: 2, msg: 'Casamento! Certo! Avance 2 casas.' }, incorrect: { action: 'stay', msg: 'Errado. Fique onde estÃ¡.' } },
            { type: 'question', text: 'O que JoÃ£o Batista era para Jesus?', correct: { action: 'move', spaces: 2, msg: 'Primo! Certo! Avance 2 casas.' }, incorrect: { action: 'stay', msg: 'Errado. Fique onde estÃ¡.' } },
            { type: 'question', text: 'Quem era o discipulo amado?', correct: { action: 'move', spaces: 2, msg: 'JoÃ£o! Certo! Avance 2 casas.' }, incorrect: { action: 'stay', msg: 'Errado. Fique onde estÃ¡.' } },
            { type: 'question', text: 'Em que Ilha foi escrita o Apocalipse?', correct: { action: 'move', spaces: 2, msg: 'Patmos! Certo! Avance 2 casas.' }, incorrect: { action: 'stay', msg: 'Errado. Fique onde estÃ¡.' } }
        ],
        8: [
            { type: 'unlucky', text: 'VocÃª tropeÃ§ou em uma pedra no caminho. Volte 2 casas.', action: 'move', spaces: -2 }
        ],
        9: [
            { type: 'question', text: 'Quem era o sogro de JacÃ³?', correct: { action: 'move', spaces: 3, msg: 'LabÃ£o! Avance 3 casas.' }, incorrect: { action: 'move', spaces: -1, msg: 'Errado! Volte 1 casa.' } },
            { type: 'question', text: 'Quem era a esposa de MoisÃ©s?', correct: { action: 'move', spaces: 3, msg: 'ZÃ­pora! Avance 3 casas.' }, incorrect: { action: 'move', spaces: -1, msg: 'Errado! Volte 1 casa.' } },
            { type: 'question', text: 'Quem foi o primeiro assassino da BÃ­blia?', correct: { action: 'move', spaces: 3, msg: 'Caim! Avance 3 casas.' }, incorrect: { action: 'move', spaces: -1, msg: 'Errado! Volte 1 casa.' } },
            { type: 'question', text: 'Quem fugiu para Tarsis?', correct: { action: 'move', spaces: 3, msg: 'Jonas! Avance 3 casas.' }, incorrect: { action: 'move', spaces: -1, msg: 'Errado! Volte 1 casa.' } }
        ],
        10: [
            { type: 'challenge', text: 'Imite a mula de BalaÃ£o com dor de barriga.', complete: { action: 'stay', msg: 'Que atuaÃ§Ã£o! Fique onde estÃ¡.' }, incomplete: { action: 'move', spaces: -3, msg: 'Sem graÃ§a! Volte 3 casas.' } },
            { type: 'challenge', text: 'Imite o som da trombeta de JericÃ³ sendo tocada no tom mais desagradÃ¡vel possÃ­vel.', complete: { action: 'move', spaces: 2, msg: 'As muralhas tremeram! Avance 2.' }, incomplete: { action: 'stay', msg: 'SilÃªncio... Fique onde estÃ¡.' } }
        ],
        11: [
            { type: 'question', text: 'Quantos livros tem na BÃ­blia?', correct: { action: 'move', spaces: 2, msg: '66! Certo! Avance 2 casas.' }, incorrect: { action: 'stay', msg: 'Incorreto. Fique aÃ­.' } },
            { type: 'question', text: 'Qual livro da BÃ­blia nÃ£o fala o nome de Deus?', correct: { action: 'move', spaces: 2, msg: 'Ester ou Cantares! Certo! Avance 2 casas.' }, incorrect: { action: 'stay', msg: 'Incorreto. Fique aÃ­.' } },
            { type: 'question', text: 'Qual o maior Salmo?', correct: { action: 'move', spaces: 2, msg: 'Salmos 119! Certo! Avance 2 casas.' }, incorrect: { action: 'stay', msg: 'Incorreto. Fique aÃ­.' } },
            { type: 'question', text: 'Que mulher tentou enganar Deus com a venda de um terreno e morreu?', correct: { action: 'move', spaces: 2, msg: 'Safira! Certo! Avance 2 casas.' }, incorrect: { action: 'stay', msg: 'Incorreto. Fique aÃ­.' } }
        ],
        12: [
            { type: 'challenge', text: 'Recite o versÃ­culo de GÃªnesis 1 completo como se vocÃª fosse gago', complete: { action: 'move', spaces: 4, msg: 'Maravilha! Avance 4 casas.' }, incomplete: { action: 'move', spaces: -2, msg: 'Precisa memorizar. Volte 2 casas.' } },
            { type: 'challenge', text: 'Recite o versÃ­culo de Salmos 91 completo como se vocÃª fosse gago', complete: { action: 'move', spaces: 4, msg: 'Maravilha! Avance 4 casas.' }, incomplete: { action: 'move', spaces: -2, msg: 'Precisa memorizar. Volte 2 casas.' } }
        ],
        13: [
            { type: 'question', text: 'Qual o Mar aberto por MoisÃ©s atravÃ©s de Deus?', correct: { action: 'move', spaces: 2, msg: 'Vermelho! Certo! Avance 2 casas.' }, incorrect: { action: 'stay', msg: 'Errado. Fique onde estÃ¡.' } },
            { type: 'question', text: 'Qual o nome da mÃ£e de MoisÃ©s?', correct: { action: 'move', spaces: 2, msg: 'Joquebede! Certo! Avance 2 casas.' }, incorrect: { action: 'stay', msg: 'Errado. Fique onde estÃ¡.' } },
            { type: 'question', text: 'Qual o nome do cego mais famoso curado por Jesus?', correct: { action: 'move', spaces: 2, msg: 'Bartimeu! Certo! Avance 2 casas.' }, incorrect: { action: 'stay', msg: 'Errado. Fique onde estÃ¡.' } },
            { type: 'question', text: 'Em qual livro estÃ¡ escrito que "o amor tudo suporta"?', correct: { action: 'move', spaces: 2, msg: '1 Corintios! Certo! Avance 2 casas.' }, incorrect: { action: 'stay', msg: 'Errado. Fique onde estÃ¡.' } }
        ],
        14: [
            { type: 'unlucky', text: 'Saulo ainda nÃ£o virou Paulo e te prendeu por ser cristÃ£o! Perca a prÃ³xima rodada.', action: 'skip' }
        ],
        15: [
            { type: 'unlucky', text: 'ComeÃ§ou o decreto dominical, vocÃª tem que se esconder, volte para o inÃ­cio do jogo.', action: 'goto', space: 0 }
        ],
        16: [
            { type: 'question', text: 'Qual o primeiro milagre de Jesus?', correct: { action: 'move', spaces: 3, msg: 'A transformaÃ§Ã£o de Ã¡gua em vinho! Certo, avance 3.' }, incorrect: { action: 'move', spaces: -1, msg: 'NÃ£o foi esse. Volte 1.' } },
            { type: 'question', text: 'Sete era filho de quem?', correct: { action: 'move', spaces: 3, msg: 'AdÃ£o e Eva! Certo, avance 3.' }, incorrect: { action: 'move', spaces: -1, msg: 'NÃ£o foi esse. Volte 1.' } },
            { type: 'question', text: 'Primogenito de Lia?', correct: { action: 'move', spaces: 3, msg: 'Ruben! Certo, avance 3.' }, incorrect: { action: 'move', spaces: -1, msg: 'NÃ£o foi esse. Volte 1.' } },
            { type: 'question', text: 'Bate Seba era o quÃª para SalomÃ£o?', correct: { action: 'move', spaces: 3, msg: 'MÃ£e! Certo, avance 3.' }, incorrect: { action: 'move', spaces: -1, msg: 'NÃ£o foi esse. Volte 1.' } }
        ],
        17: [
            { type: 'challenge', text: 'Aja como se tivesse a forÃ§a de SansÃ£o e desafie 1 pessoa do outro time para ganhar uma queda de braÃ§o.', complete: { action: 'move', spaces: 2, msg: 'Que forÃ§a! Avance 2.' }, incomplete: { action: 'stay', msg: 'Faltou espinafre! Fique onde estÃ¡.' } }
        ],
        18: [
            { type: 'question', text: 'Quem era conhecido por ser ruivo?', correct: { action: 'move', spaces: 3, msg: 'Davi! Correto. Avance 3 casas.' }, incorrect: { action: 'stay', msg: 'Incorreto. PermaneÃ§a.' } },
            { type: 'question', text: 'Quem era o profeta chorÃ£o?', correct: { action: 'move', spaces: 3, msg: 'Jeremias! Correto. Avance 3 casas.' }, incorrect: { action: 'stay', msg: 'Incorreto. PermaneÃ§a.' } },
            { type: 'question', text: 'Quem ajudou os espias em CanaÃ£?', correct: { action: 'move', spaces: 3, msg: 'Raabe! Correto. Avance 3 casas.' }, incorrect: { action: 'stay', msg: 'Incorreto. PermaneÃ§a.' } },
            { type: 'question', text: 'Rute era o que para Noemi?', correct: { action: 'move', spaces: 3, msg: 'Nora! Correto. Avance 3 casas.' }, incorrect: { action: 'stay', msg: 'Incorreto. PermaneÃ§a.' } }
        ],
        19: [
            { type: 'unlucky', text: 'Os IrmÃ£os de JosÃ© te jogaram no buraco! Volte 4 casas.', action: 'move', spaces: -4 }
        ],
        20: [
            { type: 'question', text: 'Quantos dias durou o dilÃºvio?', correct: { action: 'move', spaces: 2, msg: 'Foram 40! Correto, avance 2.' }, incorrect: { action: 'stay', msg: 'Errado. Fique onde estÃ¡.' } },
            { type: 'question', text: 'Quantas vezes o Galo cantou quando Pedro negou Jesus?', correct: { action: 'move', spaces: 2, msg: 'SÃ³ Uma! Correto, avance 2.' }, incorrect: { action: 'stay', msg: 'Errado. Fique onde estÃ¡.' } },
            { type: 'question', text: 'Quantas pragas foram enviadas ao Egito?', correct: { action: 'move', spaces: 2, msg: 'Foram 10! Correto, avance 2.' }, incorrect: { action: 'stay', msg: 'Errado. Fique onde estÃ¡.' } },
            { type: 'question', text: 'Quanto tempo o povo que saiu do Egito permaneceu no deserto?', correct: { action: 'move', spaces: 2, msg: 'Foram 40 anos! Correto, avance 2.' }, incorrect: { action: 'stay', msg: 'Errado. Fique onde estÃ¡.' } }
        ],
        21: [
            { type: 'challenge', text: 'Imite Daniel na cova dos leÃµes, VocÃª Ã© Daniel e 3 amigos vÃ£o ficar deitados deixando vocÃª acariciar a Juba Cabelo.', complete: { action: 'move', spaces: 2, msg: 'Que coragem! Avance 2.' }, incomplete: { action: 'move', spaces: -2, msg: 'Os leÃµes nÃ£o gostaram. Volte 2.' } },
            { type: 'challenge', text: 'Imite EstevÃ£o chegando no cÃ©u e dando de cara com Paulo', complete: { action: 'move', spaces: 2, msg: 'Muito Bom! Avance 2.' }, incomplete: { action: 'move', spaces: -2, msg: 'NÃ£o convenceu. Volte 2.' } }
        ],
        22: [
            { type: 'lucky', text: 'Deus te abenÃ§oou em dobro igual Eliseu! Jogue o dado novamente.', action: 'reroll' }
        ],
        23: [
            { type: 'question', text: 'Que povo nÃ£o sabia a diferenÃ§a da mÃ£o direita para esquerda?', correct: { action: 'move', spaces: 2, msg: 'Ninivitas. Correto, avance 2.' }, incorrect: { action: 'move', spaces: -2, msg: 'Errado. Volte 2.' } },
            { type: 'question', text: 'Por quantas moedas, Judas traiu Jesus?', correct: { action: 'move', spaces: 2, msg: '30 Moedas. Certo, avance 2.' }, incorrect: { action: 'move', spaces: -2, msg: 'Errado, volte 2.' } },
            { type: 'question', text: 'Que profeta mesmo apÃ³s morto ao ter seus ossos tocados, ressuscitou alguÃ©m?', correct: { action: 'move', spaces: 2, msg: 'Eliseu. Certo, avance 2.' }, incorrect: { action: 'move', spaces: -2, msg: 'Errado, volte 2.' } },
            { type: 'question', text: 'Em que monte, Elias humilhou os profetas de Baal?', correct: { action: 'move', spaces: 2, msg: 'Monte Carmelo. Certo, avance 2.' }, incorrect: { action: 'move', spaces: -2, msg: 'Errado, volte 2.' } }
        ],
        24: [
            { type: 'unlucky', text: 'Andou em cÃ­rculos no deserto por fazer bezerro de ouro. Volte a metade da jornada (casa 15).', action: 'goto', space: 15 }
        ],
        25: [
            { type: 'question', text: 'Diga o nome de dois rios que faziam parte do Ã‰den?', correct: { action: 'move', spaces: 3, msg: 'Tigre e Eufrates! Avance 3.' }, incorrect: { action: 'stay', msg: 'NÃ£o. Fique parado.' } },
            { type: 'question', text: 'Qual Igreja estÃ¡ morna, a ponto de ser vomitada?', correct: { action: 'move', spaces: 3, msg: 'LaodicÃ©ia! Avance 3.' }, incorrect: { action: 'stay', msg: 'NÃ£o. Fique parado.' } },
            { type: 'question', text: 'Qual o nome do pai de Samuel?', correct: { action: 'move', spaces: 3, msg: 'Elcana! Avance 3.' }, incorrect: { action: 'stay', msg: 'NÃ£o. Fique parado.' } },
            { type: 'question', text: 'EsaÃº vendeu sua primogenitura em troca de que?', correct: { action: 'move', spaces: 3, msg: 'Prato de Lentilhas! Avance 3.' }, incorrect: { action: 'stay', msg: 'NÃ£o. Fique parado.' } }
        ],
        26: [
            { type: 'challenge', text: 'Leia ExÃ´do 20 como narrador de futebol da TV', complete: { action: 'move', spaces: 2, msg: 'Que fÃ©! Avance 2 casas.' }, incomplete: { action: 'stay', msg: 'Afundou! Fique onde estÃ¡.' } },
            { type: 'challenge', text: 'Leia GÃªnesis 1 como narrador de futebol da TV', complete: { action: 'move', spaces: 2, msg: 'Que fÃ©! Avance 2 casas.' }, incomplete: { action: 'stay', msg: 'Afundou! Fique onde estÃ¡.' } },
            { type: 'challenge', text: 'Leia LevÃ­tico 14 como narrador de futebol da TV', complete: { action: 'move', spaces: 2, msg: 'Que fÃ©! Avance 2 casas.' }, incomplete: { action: 'stay', msg: 'Afundou! Fique onde estÃ¡.' } }
        ],
        27: [
            { type: 'question', text: 'Quem era a rival de Ana, mÃ£e de Samuel?', correct: { action: 'move', spaces: 3, msg: 'Penina! Exato, avance 3.' }, incorrect: { action: 'move', spaces: -3, msg: 'Errado. Volte 3 casas.' } },
            { type: 'question', text: 'Quem era o filho caÃ§ula de JacÃ³?', correct: { action: 'move', spaces: 3, msg: 'Benjanmin! Exato, avance 3.' }, incorrect: { action: 'move', spaces: -3, msg: 'Errado. Volte 3 casas.' } },
            { type: 'question', text: 'Abigail foi esposa de que rei?', correct: { action: 'move', spaces: 3, msg: 'Davi! Exato, avance 3.' }, incorrect: { action: 'move', spaces: -3, msg: 'Errado. Volte 3 casas.' } },
            { type: 'question', text: 'A que povo pertencia o gigante Golias?', correct: { action: 'move', spaces: 3, msg: 'Filisteu! Exato, avance 3.' }, incorrect: { action: 'move', spaces: -3, msg: 'Errado. Volte 3 casas.' } },
            { type: 'question', text: 'Quem andava com Deus e foi transladado para o cÃ©u?', correct: { action: 'move', spaces: 3, msg: 'Enoque! Exato, avance 3.' }, incorrect: { action: 'move', spaces: -3, msg: 'Errado. Volte 3 casas.' } }
        ],
        28: [
            { type: 'lucky', text: 'Anjos te guiaram. Avance 1 casa.', action: 'move', spaces: 1 }
        ],
        29: [
            { type: 'unlucky', text: 'O Apocalipse comeÃ§ou e nÃ£o achamos seu nome ainda no livro da vida, volte ao inÃ­cio do jogo!', action: 'goto', space: 0 }
        ],
        30: [
            { type: 'question', text: 'Qual filho de JacÃ³ Ã© abenÃ§oado por ele como ramo frutÃ­fero?', correct: { action: 'move', spaces: 1, msg: 'JosÃ©! Correto. Avance para a vitÃ³ria!' }, incorrect: { action: 'move', spaces: -5, msg: 'Errado. Volte 5 casas.' } },
            { type: 'question', text: 'O que Nabote tinha que o Rei Acabe queria tomar dele?', correct: { action: 'move', spaces: 1, msg: 'Sua Vinha! Correto. Avance para a vitÃ³ria!' }, incorrect: { action: 'move', spaces: -5, msg: 'Errado. Volte 5 casas.' } },
            { type: 'question', text: 'Quem era o marido de Safira?', correct: { action: 'move', spaces: 1, msg: 'Ananias! Correto. Avance para a vitÃ³ria!' }, incorrect: { action: 'move', spaces: -5, msg: 'Errado. Volte 5 casas.' } },
            { type: 'question', text: 'Qual o livro da bÃ­blia que diz que tudo Ã© vaidade?', correct: { action: 'move', spaces: 1, msg: 'Eclesiastes! Correto. Avance para a vitÃ³ria!' }, incorrect: { action: 'move', spaces: -5, msg: 'Errado. Volte 5 casas.' } },
            { type: 'question', text: 'Qual o rei que encontrou o livro da Lei, durante a restauraÃ§Ã£o do templo?', correct: { action: 'move', spaces: 1, msg: 'Josias! Correto. Avance para a vitÃ³ria!' }, incorrect: { action: 'move', spaces: -5, msg: 'Errado. Volte 5 casas.' } }
        ],
    };

    // --- GAME STATE ---
    let playerPositions = {};
    let currentPlayerIndex = 0;
    let players = [];
    let numPlayers = 0;
    let skippedTurns = {};
    let canMove = true;
    
    // --- DOM ELEMENTS ---
    const board = document.getElementById('board');
    const movePlayerBtn = document.getElementById('movePlayerBtn');
    const diceInput = document.getElementById('diceInput');
    const currentPlayerIndicator = document.getElementById('currentPlayerIndicator');
    const setupScreen = document.getElementById('setupScreen');
    const gameContainer = document.getElementById('gameContainer');
    const modal = document.getElementById('modal');
    const modalTitle = document.getElementById('modalTitle');
    const modalText = document.getElementById('modalText');
    const modalActions = document.getElementById('modalActions');

    // --- BOARD CREATION ---
    const boardPath = [
        1, 2, 3, 4, 5, 6,
        7, 8, 9, 10, 11, 12,
        13, 14, 15, 16, 17, 18,
        19, 20, 21, 22, 23, 24,
        25, 26, 27, 28, 29, 30,
    ];

    function createBoard() {
        board.innerHTML = '';

        // Start Cell
        const startCell = document.createElement('div');
        startCell.className = 'board-cell flex items-center justify-center bg-blue-900 text-white rounded-full shadow-inner font-bold text-2xl';
        startCell.textContent = 'TERRA';
        startCell.id = 'cell-0';
        board.appendChild(startCell);

        // Path Cells
        boardPath.forEach(cellNumber => {
             const cell = document.createElement('div');
             cell.id = `cell-${cellNumber}`;
             cell.className = 'board-cell bg-amber-100 border-2 border-amber-300 rounded-lg flex items-center justify-center text-xl font-bold text-amber-700 shadow';
             cell.textContent = cellNumber;
             board.appendChild(cell);
        });
        
        // Filler cells to complete the grid visually
        for(let i=0; i<4; i++) {
             const fillerCell = document.createElement('div');
             fillerCell.className = 'board-cell bg-transparent';
             board.appendChild(fillerCell);
        }

        // End Cell
        const endCell = document.createElement('div');
        endCell.className = 'board-cell flex items-center justify-center bg-sky-400 text-white rounded-full shadow-inner font-bold text-2xl';
        endCell.textContent = 'CÃ‰U';
        endCell.id = 'cell-31';
        board.appendChild(endCell);
    }
    
    // --- GAME LOGIC ---
    function startGame(teamCount) {
        numPlayers = teamCount;
        players = [{ id: 'red', name: 'Vermelho', class: 'player-red', tokenClass: 'token-red' }];
        players.push({ id: 'blue', name: 'Azul', class: 'player-blue', tokenClass: 'token-blue' });
        if (numPlayers === 3) {
            players.push({ id: 'yellow', name: 'Amarelo', class: 'player-yellow', tokenClass: 'token-yellow' });
        }
        
        createBoard();

        players.forEach(p => {
            playerPositions[p.id] = 0;
            skippedTurns[p.id] = false;
            const token = document.createElement('div');
            token.id = `token-${p.id}`;
            token.className = `player-token ${p.class}`;
            token.textContent = p.name.charAt(0);
            document.getElementById('cell-0').appendChild(token);
        });

        setupScreen.classList.add('hidden');
        gameContainer.classList.remove('hidden');
        
        currentPlayerIndex = 0;
        updateCurrentPlayerIndicator();
        renderPlayerPositions();
    }
    
    function updateCurrentPlayerIndicator() {
        const player = players[currentPlayerIndex];
        currentPlayerIndicator.className = `w-24 h-10 rounded-lg mx-auto mt-1 transition-colors bg-${player.id}-500`;
    }

    function renderPlayerPositions() {
        players.forEach(p => {
            const token = document.getElementById(`token-${p.id}`);
            const cell = document.getElementById(`cell-${playerPositions[p.id]}`);
            if (token && cell) {
                token.className = `player-token ${p.class} ${p.tokenClass}`;
                cell.appendChild(token);
            }
        });
    }

    function switchPlayer() {
        currentPlayerIndex = (currentPlayerIndex + 1) % numPlayers;
        updateCurrentPlayerIndicator();
        
        if (skippedTurns[players[currentPlayerIndex].id]) {
            skippedTurns[players[currentPlayerIndex].id] = false;
            showModal('Pular Rodada', `O time ${players[currentPlayerIndex].name} perdeu a vez e nÃ£o joga nesta rodada.`, [{ text: 'Entendi', action: () => { hideModal(); switchPlayer(); } }]);
        } else {
            canMove = true;
            movePlayerBtn.disabled = false;
            diceInput.disabled = false;
            movePlayerBtn.classList.remove('opacity-50', 'cursor-not-allowed');
            diceInput.value = '';
            diceInput.focus();
        }
    }

    movePlayerBtn.addEventListener('click', () => {
        if (!canMove) return;

        const roll = parseInt(diceInput.value, 10);

        if (isNaN(roll) || roll < 1 || roll > 6) {
            showModal('Entrada InvÃ¡lida', 'Por favor, insira um nÃºmero de 1 a 6 no campo do dado.', [{ text: 'Ok', action: hideModal, class: 'bg-red-500' }]);
            return;
        }

        canMove = false;
        movePlayerBtn.disabled = true;
        diceInput.disabled = true;
        movePlayerBtn.classList.add('opacity-50', 'cursor-not-allowed');

        movePlayer(roll);
    });

    function movePlayer(steps) {
        const player = players[currentPlayerIndex];
        const oldPosition = playerPositions[player.id];
        let newPosition = oldPosition + steps;
        
        if (newPosition >= 31) {
            newPosition = 31;
            playerPositions[player.id] = newPosition;
            renderPlayerPositions();
            setTimeout(() => showWinner(player), 500);
            return;
        }

        playerPositions[player.id] = newPosition;
        renderPlayerPositions();

        setTimeout(() => handleSpaceEvent(newPosition), 800);
    }
    
    function applyConsequence(consequence) {
        hideModal();
        const player = players[currentPlayerIndex];
        
        if (consequence.msg) {
            setTimeout(() => {
                showModal('Resultado', consequence.msg, [{ text: 'Ok', action: () => {
                    hideModal();
                    applyAction(consequence);
                } }]);
            }, 500);
        } else {
            applyAction(consequence);
        }
    }

    function applyAction(consequence) {
        const player = players[currentPlayerIndex];
        switch (consequence.action) {
            case 'move':
                playerPositions[player.id] += consequence.spaces;
                if (playerPositions[player.id] < 0) playerPositions[player.id] = 0;
                if (playerPositions[player.id] >= 31) playerPositions[player.id] = 31;
                renderPlayerPositions();
                if (playerPositions[player.id] === 31) {
                    setTimeout(() => showWinner(player), 500);
                } else {
                    setTimeout(switchPlayer, 800);
                }
                break;
            case 'goto':
                playerPositions[player.id] = consequence.space;
                renderPlayerPositions();
                setTimeout(switchPlayer, 800);
                break;
            case 'skip':
                skippedTurns[player.id] = true;
                switchPlayer();
                break;
            case 'reroll':
                canMove = true;
                movePlayerBtn.disabled = false;
                diceInput.disabled = false;
                movePlayerBtn.classList.remove('opacity-50', 'cursor-not-allowed');
                diceInput.value = '';
                diceInput.focus();
                break;
            case 'stay':
            default:
                switchPlayer();
                break;
        }
    }

    function handleSpaceEvent(spaceNumber) {
        const challengeOptions = challenges[spaceNumber];
        if (!challengeOptions || challengeOptions.length === 0) {
            switchPlayer();
            return;
        }

        // Pick a random challenge from the available options for that space
        const challenge = challengeOptions[Math.floor(Math.random() * challengeOptions.length)];

        const title = `Casa ${spaceNumber}`;
        const text = challenge.text;
        let actions = [];

        switch (challenge.type) {
            case 'question':
                actions.push({ text: 'Acertei', action: () => applyConsequence(challenge.correct), class: 'bg-green-500' });
                actions.push({ text: 'Errei', action: () => applyConsequence(challenge.incorrect), class: 'bg-red-500' });
                break;
            case 'challenge':
                actions.push({ text: 'Desafio Cumprido!', action: () => applyConsequence(challenge.complete), class: 'bg-blue-500' });
                actions.push({ text: 'NÃ£o cumpri', action: () => applyConsequence(challenge.incomplete), class: 'bg-yellow-500' });
                break;
            case 'lucky':
            case 'unlucky':
                actions.push({ text: 'Ok', action: () => applyConsequence(challenge), class: 'bg-stone-500' });
                break;
        }
        showModal(title, text, actions);
    }

    function showModal(title, text, actions = []) {
        modalTitle.textContent = title;
        modalText.textContent = text;
        modalActions.innerHTML = '';
        actions.forEach(act => {
            const btn = document.createElement('button');
            btn.textContent = act.text;
            btn.className = `${act.class || 'bg-gray-500'} text-white font-bold py-2 px-6 rounded-lg hover:opacity-90 transition`;
            btn.onclick = act.action;
            modalActions.appendChild(btn);
        });
        modal.classList.add('active');
    }

    function hideModal() {
        modal.classList.remove('active');
    }
    
    function showWinner(player) {
        const actions = [{
            text: 'Jogar Novamente',
            action: () => {
                hideModal();
                location.reload(); // Simple way to restart
            },
            class: 'bg-amber-600'
        }];
        showModal(`ðŸŽ‰ VitÃ³ria do Time ${player.name}! ðŸŽ‰`, 'ParabÃ©ns por completarem a jornada bÃ­blica! VocÃªs chegaram Ã  terra prometida.', actions);
    }

</script>
</body>
</html>

